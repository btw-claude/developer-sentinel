# Developer Sentinel Docker Compose Configuration
#
# Usage:
#   docker-compose up -d      # Start in background
#   docker-compose logs -f    # View logs
#   docker-compose down       # Stop service

services:
  sentinel:
    build:
      context: ../..
      dockerfile: examples/docker/Dockerfile
    container_name: developer-sentinel
    restart: unless-stopped

    # Environment configuration
    env_file:
      - .env

    # Volume mounts for persistent data
    volumes:
      # Orchestration configs (read-only)
      - ./orchestrations:/app/orchestrations:ro
      # Working directories for agent execution
      - ./workdir:/app/workdir
      # Execution logs
      - ./logs:/app/logs

    # Health check configuration
    healthcheck:
      test: ["CMD", "python", "-c", "import sentinel; print('healthy')"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s

    # Resource limits (adjust as needed)
    deploy:
      resources:
        limits:
          memory: 1G
        reservations:
          memory: 256M

    # Logging configuration
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"

    # Network configuration
    networks:
      - sentinel-network

networks:
  sentinel-network:
    driver: bridge
