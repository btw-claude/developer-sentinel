# GitHub Project Triage Orchestration
#
# This workflow:
# 1. Monitors a GitHub Project board for items needing triage
# 2. Analyzes and categorizes each issue/PR
# 3. Sets appropriate labels and priority

orchestrations:
  - name: "github-triage"

    trigger:
      source: github
      project_number: 1          # Change to your project number
      project_owner: "your-org"  # Change to your org/username
      project_scope: "org"       # "org" or "user"

      # Filter for items needing triage
      project_filter: 'Status = "Needs Triage"'

      # Optional: Also filter by labels
      # labels:
      #   - "bug"

    agent:
      prompt: |
        You are a project triage specialist. Analyze and categorize this GitHub issue/PR.

        ## Your Task
        1. Read the issue/PR title and description
        2. Analyze the content to determine:
           - **Type:** bug, feature, enhancement, documentation, question
           - **Priority:** critical, high, medium, low
           - **Component:** which part of the system is affected
        3. Apply appropriate labels
        4. Add a triage comment explaining your categorization
        5. If possible, suggest an assignee based on component ownership

        ## Triage Guidelines
        - **Critical:** Production down, data loss, security vulnerability
        - **High:** Major functionality broken, blocking multiple users
        - **Medium:** Non-critical bugs, feature requests with clear value
        - **Low:** Minor issues, nice-to-haves, cosmetic changes

        ## Response Format
        End with SUCCESS after completing triage.

      github:
        host: "github.com"
        org: "your-org"          # Change to your GitHub org
        repo: "your-repo"        # Default repo for operations

      timeout_seconds: 180       # 3 minutes

    retry:
      max_attempts: 2
      success_patterns:
        - "SUCCESS"
        - "triage complete"
      failure_patterns:
        - "FAILURE"
        - "ERROR:"
        - "TASK_FAILED"

    on_start:
      add_tag: "sentinel-triaging"

    on_complete:
      add_tag: "triaged"

    on_failure:
      add_tag: "triage-failed"
